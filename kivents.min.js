"use strict";const KIVENTS=function(e){const n=this,t=new Map;let o=0;function c(...e){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(...e)}const u={debug:!1,highSpeed:!1,errorFunc:c,logFunc:function(...e){"undefined"!=typeof console&&"function"==typeof console.log&&console.log(...e)}};function r(...e){try{u.logFunc(...e)}catch(n){c("logFunc error,",n,...e)}}function i(...e){try{u.errorFunc(...e)}catch(n){c("errorFunc error,",n,...e)}}function f(e,n,c,r){if("function"==typeof n&&(c=n,n=Math.random().toString(36).slice(2)+"_"+o++),"function"!=typeof c)return u.debug&&i("Event callback must be a function for target: "+e+" name: "+n),null;if("string"!=typeof e||""===e)return u.debug&&i("Event target must be a valid string! target: ?"),null;if("string"!=typeof n||""===n)return u.debug&&i("Event name must be a valid string! target: "+e+" name: ?"),null;let f=t.get(e);return f||(f=new Map,t.set(e,f)),f.set(n,{once:!!r,callbackFunc:c}),n}"object"==typeof e&&("boolean"==typeof e.debug&&(u.debug=e.debug),"boolean"==typeof e.highSpeed&&(u.highSpeed=e.highSpeed),"function"==typeof e.errorFunc&&(u.errorFunc=e.errorFunc),"function"==typeof e.logFunc&&(u.logFunc=e.logFunc)),n.getEvents=function(){return u.debug?t:null},n.on=function(e,n,t){return f(e,n,t,!1)},n.once=function(e,n,t){return f(e,n,t,!0)},n.off=function(e,n){const o=t.get(e);return!!o&&(""!==n&&null!=n&&o.has(n)?(o.delete(n),0===o.size&&t.delete(e)):t.delete(e),!0)},n.run=function(e,n,o){if(void 0===o&&(o=u.debug),!t.has(e))return;const c=t.get(e),f=[],l=c.size;c.forEach(function(t,o){if(t&&"function"==typeof t.callbackFunc){if(u.highSpeed)t.callbackFunc(n);else try{t.callbackFunc(n)}catch(n){u.debug&&i("Event error",e,o,n)}t.once&&f.push(o)}});for(const e of f)c.delete(e);if(!u.highSpeed&&u.debug&&o){const t=c.size,o=t===l?"Ran: "+l:"Ran: "+l+", Remained: "+t;null!=n&&""!=n?r("Events:",e+"["+o+"]",n):r("Events:",e+"["+o+"]")}0===c.size&&t.delete(e)}};
